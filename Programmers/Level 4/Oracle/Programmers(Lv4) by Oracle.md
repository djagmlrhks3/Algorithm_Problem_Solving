# Programmers(Lv4) by Oracle

### 우유와 요거트가 담긴 장바구니

```SQL
SELECT CART_ID
  FROM CART_PRODUCTS
 WHERE NAME = 'Milk' 
   AND CART_ID IN (SELECT CART_ID FROM CART_PRODUCTS WHERE NAME = 'Yogurt')
 ORDER BY CART_ID
```



### 입양 시각 구하기(2)

> CONNECT BY

```mysql
SELECT A.HOUR, COUNT(B.HOUR)
  FROM (SELECT LEVEL-1 AS HOUR
          FROM DUAL
       CONNECT BY LEVEL <= 24) A,
       (SELECT TO_CHAR(DATETIME, 'HH24') AS HOUR
          FROM ANIMAL_OUTS) B
 WHERE A.HOUR = B.HOUR(+)
 GROUP BY A.HOUR
 ORDER BY A.HOUR
```



>WITH AS & RECURSIVE

```SQL
WITH TIME(H) AS (
  SELECT 0
    FROM DUAL
   UNION ALL
  SELECT H+1
    FROM TIME
   WHERE H < 23
)
SELECT A.H AS HOUR, COUNT(B.HOUR) AS COUNT
  FROM TIME A,
       (SELECT TO_CHAR(DATETIME, 'HH24') AS HOUR
          FROM ANIMAL_OUTS) B
 WHERE A.H = B.HOUR(+)
 GROUP BY A.H
 ORDER BY A.H
```



### 보호소에서 중성화한 동물

```SQL
SELECT A.ANIMAL_ID, A.ANIMAL_TYPE, A.NAME
  FROM ANIMAL_INS A,
       ANIMAL_OUTS B
 WHERE A.ANIMAL_ID = B.ANIMAL_ID
   AND A.SEX_UPON_INTAKE LIKE '%Intact%'
   AND (B.SEX_UPON_OUTCOME LIKE '%Spayed%' OR B.SEX_UPON_OUTCOME LIKE '%Neutered%')
 ORDER BY A.ANIMAL_ID
```



